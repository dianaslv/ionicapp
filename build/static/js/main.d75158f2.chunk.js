(this.webpackJsonpmyApp=this.webpackJsonpmyApp||[]).push([[1],{105:function(e,t,n){},106:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),o=n(30),c=n.n(o),i=n(22),s=n(2),u=n(61),l=n(13),m=function(e){var t=e.id,n=e.text,r=e.onEdit;return a.a.createElement(s.j,{onClick:function(){return r(t)}},a.a.createElement(s.k,null,n))},E=function(e){return function(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return(t=console).log.apply(t,[e].concat(r))}},f=n(10),p=n.n(f),d=n(15),j=n(26),y=n(37),v=n(14),h=n(38),b=n.n(h),g=E("itemApi"),_="http://".concat("127.0.0.0:3000","/item");function O(e,t){return g("".concat(t," - started")),e.then((function(e){return g("".concat(t," - succeeded")),Promise.resolve(e.data)})).catch((function(e){return g("".concat(t," - failed")),Promise.reject(e)}))}var I={headers:{"Content-Type":"application/json"}},T=function(){return O(b.a.get(_,I),"getItems")},k=function(e){return O(b.a.post(_,e,I),"createItem")},w=function(e){return O(b.a.put("".concat(_,"/").concat(e.id),e,I),"updateItem")},x=E("ItemProvider"),C={fetching:!1,saving:!1},S=function(e,t){var n=t.type,r=t.payload;switch(n){case"FETCH_ITEMS_STARTED":return Object(v.a)(Object(v.a)({},e),{},{fetching:!0,fetchingError:null});case"FETCH_ITEMS_SUCCEEDED":return Object(v.a)(Object(v.a)({},e),{},{items:r.items,fetching:!1});case"FETCH_ITEMS_FAILED":return Object(v.a)(Object(v.a)({},e),{},{fetchingError:r.error,fetching:!1});case"SAVE_ITEM_STARTED":return Object(v.a)(Object(v.a)({},e),{},{savingError:null,saving:!0});case"SAVE_ITEM_SUCCEEDED":var a=Object(y.a)(e.items||[]),o=r.item,c=a.findIndex((function(e){return e.id===o.id}));return-1===c?a.splice(0,0,o):a[c]=o,Object(v.a)(Object(v.a)({},e),{},{items:a,saving:!1});case"SAVE_ITEM_FAILED":return Object(v.a)(Object(v.a)({},e),{},{savingError:r.error,saving:!1});default:return e}},D=a.a.createContext(C),A=function(e){var t=e.children,n=Object(r.useReducer)(S,C),o=Object(j.a)(n,2),c=o[0],i=o[1],s=c.items,u=c.fetching,l=c.fetchingError,m=c.saving,E=c.savingError;Object(r.useEffect)((function(){var e=!1;return function(){t.apply(this,arguments)}(),function(){e=!0};function t(){return(t=Object(d.a)(p.a.mark((function t(){var n;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,x("fetchItems started"),i({type:"FETCH_ITEMS_STARTED"}),t.next=5,T();case 5:n=t.sent,x("fetchItems succeeded"),e||i({type:"FETCH_ITEMS_SUCCEEDED",payload:{items:n}}),t.next=14;break;case 10:t.prev=10,t.t0=t.catch(0),x("fetchItems failed"),i({type:"FETCH_ITEMS_FAILED",payload:{error:t.t0}});case 14:case"end":return t.stop()}}),t,null,[[0,10]])})))).apply(this,arguments)}}),[]),Object(r.useEffect)((function(){var e=!1;x("wsEffect - connecting");var t=function(e){var t=new WebSocket("ws://".concat("127.0.0.0:3000"));return t.onopen=function(){g("web socket onopen")},t.onclose=function(){g("web socket onclose")},t.onerror=function(e){g("web socket onerror",e)},t.onmessage=function(t){g("web socket onmessage"),e(JSON.parse(t.data))},function(){t.close()}}((function(t){if(!e){var n=t.event,r=t.payload.item;x("ws message, item ".concat(n)),"created"!==n&&"updated"!==n||i({type:"SAVE_ITEM_SUCCEEDED",payload:{item:r}})}}));return function(){x("wsEffect - disconnecting"),e=!0,t()}}),[]);var f={items:s,fetching:u,fetchingError:l,saving:m,savingError:E,saveItem:Object(r.useCallback)((function(e){return y.apply(this,arguments)}),[])};return x("returns"),a.a.createElement(D.Provider,{value:f},t);function y(){return(y=Object(d.a)(p.a.mark((function e(t){var n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,x("saveItem started"),i({type:"SAVE_ITEM_STARTED"}),e.next=5,t.id?w(t):k(t);case 5:n=e.sent,x("saveItem succeeded"),i({type:"SAVE_ITEM_SUCCEEDED",payload:{item:n}}),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(0),x("saveItem failed"),i({type:"SAVE_ITEM_FAILED",payload:{error:e.t0}});case 14:case"end":return e.stop()}}),e,null,[[0,10]])})))).apply(this,arguments)}},M=E("ItemList"),F=function(e){var t=e.history,n=Object(r.useContext)(D),o=n.items,c=n.fetching,i=n.fetchingError;return M("render"),a.a.createElement(s.n,null,a.a.createElement(s.g,null,a.a.createElement(s.r,null,a.a.createElement(s.q,null,"My App"))),a.a.createElement(s.d,null,a.a.createElement(s.m,{isOpen:c,message:"Fetching items"}),o&&a.a.createElement(s.l,null,o.map((function(e){var n=e.id,r=e.text;return a.a.createElement(m,{key:n,id:n,text:r,onEdit:function(e){return t.push("/item/".concat(e))}})}))),i&&a.a.createElement("div",null,i.message||"Failed to fetch items"),a.a.createElement(s.e,{vertical:"bottom",horizontal:"end",slot:"fixed"},a.a.createElement(s.f,{onClick:function(){return t.push("/item")}},a.a.createElement(s.h,{icon:l.a})))))},U=E("ItemEdit"),L=function(e){var t=e.history,n=e.match,o=Object(r.useContext)(D),c=o.items,i=o.saving,u=o.savingError,l=o.saveItem,m=Object(r.useState)(""),E=Object(j.a)(m,2),f=E[0],p=E[1],d=Object(r.useState)(),y=Object(j.a)(d,2),h=y[0],b=y[1];Object(r.useEffect)((function(){U("useEffect");var e=n.params.id||"",t=null===c||void 0===c?void 0:c.find((function(t){return t.id===e}));b(t),t&&p(t.text)}),[n.params.id,c]);return U("render"),a.a.createElement(s.n,null,a.a.createElement(s.g,null,a.a.createElement(s.r,null,a.a.createElement(s.q,null,"Edit"),a.a.createElement(s.c,{slot:"end"},a.a.createElement(s.b,{onClick:function(){var e=h?Object(v.a)(Object(v.a)({},h),{},{text:f}):{text:f};l&&l(e).then((function(){return t.goBack()}))}},"Save")))),a.a.createElement(s.d,null,a.a.createElement(s.i,{value:f,onIonChange:function(e){return p(e.detail.value||"")}}),a.a.createElement(s.m,{isOpen:i}),u&&a.a.createElement("div",null,u.message||"Failed to save item")))},V=(n(95),n(96),n(97),n(98),n(99),n(100),n(101),n(102),n(103),n(104),n(105),function(){return a.a.createElement(s.a,null,a.a.createElement(A,null,a.a.createElement(u.a,null,a.a.createElement(s.p,null,a.a.createElement(i.b,{path:"/items",component:F,exact:!0}),a.a.createElement(i.b,{path:"/item",component:L,exact:!0}),a.a.createElement(i.b,{path:"/item/:id",component:L,exact:!0}),a.a.createElement(i.b,{exact:!0,path:"/",render:function(){return a.a.createElement(i.a,{to:"/items"})}})))))});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(a.a.createElement(V,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},66:function(e,t,n){e.exports=n(106)},72:function(e,t,n){var r={"./ion-action-sheet.entry.js":[108,5],"./ion-alert.entry.js":[109,6],"./ion-app_8.entry.js":[110,7],"./ion-avatar_3.entry.js":[111,18],"./ion-back-button.entry.js":[112,19],"./ion-backdrop.entry.js":[113,43],"./ion-button_2.entry.js":[114,20],"./ion-card_5.entry.js":[115,21],"./ion-checkbox.entry.js":[116,22],"./ion-chip.entry.js":[117,23],"./ion-col_3.entry.js":[118,44],"./ion-datetime_3.entry.js":[119,10],"./ion-fab_3.entry.js":[120,24],"./ion-img.entry.js":[121,45],"./ion-infinite-scroll_2.entry.js":[122,46],"./ion-input.entry.js":[123,25],"./ion-item-option_3.entry.js":[124,26],"./ion-item_8.entry.js":[125,27],"./ion-loading.entry.js":[126,28],"./ion-menu_3.entry.js":[127,29],"./ion-modal.entry.js":[128,8],"./ion-nav_2.entry.js":[129,15],"./ion-popover.entry.js":[130,9],"./ion-progress-bar.entry.js":[131,30],"./ion-radio_2.entry.js":[132,31],"./ion-range.entry.js":[133,32],"./ion-refresher_2.entry.js":[134,11],"./ion-reorder_2.entry.js":[135,17],"./ion-ripple-effect.entry.js":[136,47],"./ion-route_4.entry.js":[137,33],"./ion-searchbar.entry.js":[138,34],"./ion-segment_2.entry.js":[139,35],"./ion-select_3.entry.js":[140,36],"./ion-slide_2.entry.js":[141,48],"./ion-spinner.entry.js":[142,13],"./ion-split-pane.entry.js":[143,49],"./ion-tab-bar_2.entry.js":[144,37],"./ion-tab_2.entry.js":[145,16],"./ion-text.entry.js":[146,38],"./ion-textarea.entry.js":[147,39],"./ion-toast.entry.js":[148,40],"./ion-toggle.entry.js":[149,12],"./ion-virtual-scroll.entry.js":[150,50]};function a(e){if(!n.o(r,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=r[e],a=t[0];return n.e(t[1]).then((function(){return n(a)}))}a.keys=function(){return Object.keys(r)},a.id=72,e.exports=a},74:function(e,t,n){var r={"./ion-icon.entry.js":[154,57]};function a(e){if(!n.o(r,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=r[e],a=t[0];return n.e(t[1]).then((function(){return n(a)}))}a.keys=function(){return Object.keys(r)},a.id=74,e.exports=a}},[[66,3,4]]]);
//# sourceMappingURL=main.d75158f2.chunk.js.map